#!/usr/bin/env python3


import os
from sys import argv
from collections import defaultdict

def main():
    infile = argv[1]
    prefix = argv[2]
    list_loci = ['lmo0002', 'lmo0003', 'lmo0005', 'lmo0006', 'lmo0007', 'lmo0009', 'lmo0010', 'lmo0011', 'lmo0012', 'lmo0015', 'lmo0016', 'lmo0018', 'lmo0019', 'lmo0020', 'lmo0021', 'lmo0022', 'lmo0023', 'lmo0024', 'lmo0025', 'lmo0026', 'lmo0027', 'lmo0029', 'lmo0030', 'lmo0031', 'lmo0033', 'lmo0034', 'lmo0035', 'lmo0042', 'lmo0043', 'lmo0044', 'lmo0046', 'lmo0047', 'lmo0048', 'lmo0049', 'lmo0052', 'lmo0053', 'lmo0054', 'lmo0055', 'lmo0056', 'lmo0057', 'lmo0059', 'lmo0060', 'lmo0083', 'lmo0084', 'lmo0087', 'lmo0088', 'lmo0089', 'lmo0090', 'lmo0091', 'lmo0092', 'lmo0095', 'lmo0096', 'lmo0097', 'lmo0098', 'lmo0099', 'lmo0100', 'lmo0101', 'lmo0102', 'lmo0103', 'lmo0104', 'lmo0110', 'lmo0111', 'lmo0112', 'lmo0113', 'lmo0114', 'lmo0115', 'lmo0116', 'lmo0128', 'lmo0130', 'lmo0131', 'lmo0132', 'lmo0133', 'lmo0134', 'lmo0135', 'lmo0136', 'lmo0137', 'lmo0153', 'lmo0154', 'lmo0155', 'lmo0156', 'lmo0157', 'lmo0158', 'lmo0161', 'lmo0162', 'lmo0163', 'lmo0164', 'lmo0165', 'lmo0166', 'lmo0167', 'lmo0168', 'lmo0169', 'lmo0170', 'lmo0176', 'lmo0177', 'lmo0185', 'lmo0186', 'lmo0187', 'lmo0188', 'lmo0189', 'lmo0190', 'lmo0191', 'lmo0192', 'lmo0193', 'lmo0197', 'lmo0198', 'lmo0199', 'lmo0202', 'lmo0203', 'lmo0205', 'lmo0207', 'lmo0208', 'lmo0211', 'lmo0212', 'lmo0213', 'lmo0215', 'lmo0216', 'lmo0217', 'lmo0220', 'lmo0221', 'lmo0222', 'lmo0223', 'lmo0225', 'lmo0226', 'lmo0227', 'lmo0228', 'lmo0229', 'lmo0230', 'lmo0231', 'lmo0232', 'lmo0233', 'lmo0235', 'lmo0236', 'lmo0250', 'lmo0251', 'lmo0256', 'lmo0258', 'lmo0259', 'lmo0260', 'lmo0266', 'lmo0268', 'lmo0270', 'lmo0271', 'lmo0272', 'lmo0274', 'lmo0276', 'lmo0278', 'lmo0280', 'lmo0281', 'lmo0282', 'lmo0283', 'lmo0284', 'lmo0285', 'lmo0286', 'lmo0287', 'lmo0288', 'lmo0289', 'lmo0290', 'lmo0291', 'lmo0292', 'lmo0293', 'lmo0296', 'lmo0297', 'lmo0299', 'lmo0300', 'lmo0301', 'lmo0305', 'lmo0314', 'lmo0316', 'lmo0317', 'lmo0318', 'lmo0321', 'lmo0343', 'lmo0345', 'lmo0346', 'lmo0347', 'lmo0348', 'lmo0349', 'lmo0350', 'lmo0351', 'lmo0352', 'lmo0353', 'lmo0354', 'lmo0355', 'lmo0356', 'lmo0368', 'lmo0369', 'lmo0370', 'lmo0371', 'lmo0372', 'lmo0374', 'lmo0375', 'lmo0383', 'lmo0385', 'lmo0386', 'lmo0387', 'lmo0388', 'lmo0389', 'lmo0390', 'lmo0391', 'lmo0392', 'lmo0393', 'lmo0394', 'lmo0396', 'lmo0397', 'lmo0401', 'lmo0402', 'lmo0403', 'lmo0404', 'lmo0405', 'lmo0406', 'lmo0407', 'lmo0408', 'lmo0413', 'lmo0416', 'lmo0418', 'lmo0424', 'lmo0429', 'lmo0430', 'lmo0431', 'lmo0432', 'lmo0437', 'lmo0442', 'lmo0443', 'lmo0449', 'lmo0450', 'lmo0452', 'lmo0453', 'lmo0454', 'lmo0455', 'lmo0456', 'lmo0457', 'lmo0458', 'lmo0480', 'lmo0481', 'lmo0482', 'lmo0483', 'lmo0484', 'lmo0485', 'lmo0487', 'lmo0488', 'lmo0489', 'lmo0490', 'lmo0491', 'lmo0494', 'lmo0509', 'lmo0510', 'lmo0512', 'lmo0513', 'lmo0515', 'lmo0516', 'lmo0517', 'lmo0518', 'lmo0520', 'lmo0521', 'lmo0522', 'lmo0523', 'lmo0527', 'lmo0528', 'lmo0529', 'lmo0530', 'lmo0531', 'lmo0532', 'lmo0533', 'lmo0534', 'lmo0535', 'lmo0536', 'lmo0537', 'lmo0538', 'lmo0539', 'lmo0540', 'lmo0542', 'lmo0543', 'lmo0544', 'lmo0545', 'lmo0546', 'lmo0547', 'lmo0553', 'lmo0554', 'lmo0555', 'lmo0556', 'lmo0558', 'lmo0559', 'lmo0560', 'lmo0563', 'lmo0564', 'lmo0565', 'lmo0566', 'lmo0567', 'lmo0568', 'lmo0569', 'lmo0570', 'lmo0571', 'lmo0572', 'lmo0573', 'lmo0574', 'lmo0575', 'lmo0577', 'lmo0578', 'lmo0579', 'lmo0580', 'lmo0583', 'lmo0584', 'lmo0585', 'lmo0587', 'lmo0589', 'lmo0590', 'lmo0591', 'lmo0592', 'lmo0593', 'lmo0594', 'lmo0595', 'lmo0596', 'lmo0597', 'lmo0602', 'lmo0603', 'lmo0604', 'lmo0605', 'lmo0608', 'lmo0609', 'lmo0610', 'lmo0611', 'lmo0612', 'lmo0613', 'lmo0615', 'lmo0616', 'lmo0617', 'lmo0619', 'lmo0620', 'lmo0621', 'lmo0622', 'lmo0623', 'lmo0624', 'lmo0625', 'lmo0626', 'lmo0628', 'lmo0635', 'lmo0636', 'lmo0637', 'lmo0639', 'lmo0640', 'lmo0641', 'lmo0642', 'lmo0643', 'lmo0644', 'lmo0646', 'lmo0647', 'lmo0648', 'lmo0649', 'lmo0650', 'lmo0651', 'lmo0652', 'lmo0654', 'lmo0655', 'lmo0656', 'lmo0657', 'lmo0659', 'lmo0661', 'lmo0662', 'lmo0663', 'lmo0664', 'lmo0665', 'lmo0666', 'lmo0667', 'lmo0668', 'lmo0669', 'lmo0670', 'lmo0672', 'lmo0673', 'lmo0675', 'lmo0676', 'lmo0677', 'lmo0678', 'lmo0680', 'lmo0681', 'lmo0682', 'lmo0683', 'lmo0684', 'lmo0685', 'lmo0686', 'lmo0687', 'lmo0688', 'lmo0689', 'lmo0690', 'lmo0691', 'lmo0692', 'lmo0693', 'lmo0694', 'lmo0695', 'lmo0696', 'lmo0697', 'lmo0698', 'lmo0699', 'lmo0700', 'lmo0701', 'lmo0703', 'lmo0704', 'lmo0705', 'lmo0706', 'lmo0707', 'lmo0708', 'lmo0709', 'lmo0710', 'lmo0711', 'lmo0712', 'lmo0713', 'lmo0714', 'lmo0715', 'lmo0716', 'lmo0717', 'lmo0718', 'lmo0719', 'lmo0720', 'lmo0721', 'lmo0722', 'lmo0724', 'lmo0727', 'lmo0729', 'lmo0732', 'lmo0741', 'lmo0743', 'lmo0745', 'lmo0755', 'lmo0756', 'lmo0757', 'lmo0758', 'lmo0760', 'lmo0762', 'lmo0763', 'lmo0764', 'lmo0772', 'lmo0773', 'lmo0774', 'lmo0775', 'lmo0776', 'lmo0777', 'lmo0779', 'lmo0781', 'lmo0782', 'lmo0787', 'lmo0788', 'lmo0790', 'lmo0791', 'lmo0793', 'lmo0794', 'lmo0799', 'lmo0800', 'lmo0802', 'lmo0804', 'lmo0807', 'lmo0808', 'lmo0809', 'lmo0810', 'lmo0811', 'lmo0812', 'lmo0813', 'lmo0817', 'lmo0818', 'lmo0819', 'lmo0820', 'lmo0821', 'lmo0823', 'lmo0824', 'lmo0829', 'lmo0830', 'lmo0831', 'lmo0836', 'lmo0838', 'lmo0839', 'lmo0840', 'lmo0841', 'lmo0844', 'lmo0846', 'lmo0847', 'lmo0848', 'lmo0850', 'lmo0853', 'lmo0854', 'lmo0855', 'lmo0856', 'lmo0857', 'lmo0858', 'lmo0860', 'lmo0861', 'lmo0862', 'lmo0863', 'lmo0864', 'lmo0865', 'lmo0866', 'lmo0867', 'lmo0871', 'lmo0872', 'lmo0874', 'lmo0875', 'lmo0876', 'lmo0877', 'lmo0878', 'lmo0879', 'lmo0881', 'lmo0882', 'lmo0883', 'lmo0884', 'lmo0885', 'lmo0886', 'lmo0887', 'lmo0889', 'lmo0894', 'lmo0896', 'lmo0897', 'lmo0899', 'lmo0900', 'lmo0901', 'lmo0905', 'lmo0906', 'lmo0907', 'lmo0908', 'lmo0909', 'lmo0911', 'lmo0912', 'lmo0913', 'lmo0914', 'lmo0915', 'lmo0916', 'lmo0917', 'lmo0920', 'lmo0921', 'lmo0922', 'lmo0926', 'lmo0927', 'lmo0928', 'lmo0929', 'lmo0931', 'lmo0932', 'lmo0935', 'lmo0936', 'lmo0937', 'lmo0938', 'lmo0939', 'lmo0941', 'lmo0942', 'lmo0943', 'lmo0944', 'lmo0945', 'lmo0946', 'lmo0947', 'lmo0948', 'lmo0951', 'lmo0952', 'lmo0953', 'lmo0954', 'lmo0955', 'lmo0956', 'lmo0958', 'lmo0960', 'lmo0961', 'lmo0962', 'lmo0963', 'lmo0965', 'lmo0966', 'lmo0967', 'lmo0969', 'lmo0970', 'lmo0972', 'lmo0973', 'lmo0975', 'lmo0976', 'lmo0977', 'lmo0978', 'lmo0979', 'lmo0980', 'lmo0983', 'lmo0984', 'lmo0985', 'lmo0986', 'lmo0988', 'lmo0989', 'lmo0991', 'lmo0992', 'lmo0993', 'lmo0994', 'lmo0996', 'lmo0997', 'lmo0999', 'lmo1000', 'lmo1002', 'lmo1003', 'lmo1005', 'lmo1006', 'lmo1007', 'lmo1008', 'lmo1009', 'lmo1010', 'lmo1011', 'lmo1012', 'lmo1013', 'lmo1014', 'lmo1016', 'lmo1017', 'lmo1018', 'lmo1019', 'lmo1020', 'lmo1021', 'lmo1022', 'lmo1025', 'lmo1026', 'lmo1027', 'lmo1028', 'lmo1029', 'lmo1038', 'lmo1039', 'lmo1040', 'lmo1041', 'lmo1042', 'lmo1044', 'lmo1045', 'lmo1046', 'lmo1047', 'lmo1048', 'lmo1049', 'lmo1051', 'lmo1052', 'lmo1053', 'lmo1054', 'lmo1058', 'lmo1059', 'lmo1064', 'lmo1065', 'lmo1067', 'lmo1070', 'lmo1071', 'lmo1072', 'lmo1073', 'lmo1074', 'lmo1075', 'lmo1089', 'lmo1092', 'lmo1093', 'lmo1094', 'lmo1095', 'lmo1096', 'lmo1126', 'lmo1131', 'lmo1132', 'lmo1133', 'lmo1135', 'lmo1137', 'lmo1138', 'lmo1140', 'lmo1141', 'lmo1142', 'lmo1143', 'lmo1144', 'lmo1145', 'lmo1146', 'lmo1147', 'lmo1149', 'lmo1150', 'lmo1152', 'lmo1153', 'lmo1154', 'lmo1155', 'lmo1156', 'lmo1157', 'lmo1158', 'lmo1160', 'lmo1161', 'lmo1162', 'lmo1163', 'lmo1164', 'lmo1166', 'lmo1167', 'lmo1169', 'lmo1170', 'lmo1171', 'lmo1172', 'lmo1174', 'lmo1175', 'lmo1176', 'lmo1177', 'lmo1178', 'lmo1179', 'lmo1181', 'lmo1182', 'lmo1183', 'lmo1184', 'lmo1185', 'lmo1187', 'lmo1190', 'lmo1191', 'lmo1192', 'lmo1193', 'lmo1194', 'lmo1195', 'lmo1196', 'lmo1198', 'lmo1199', 'lmo1200', 'lmo1201', 'lmo1202', 'lmo1203', 'lmo1204', 'lmo1205', 'lmo1206', 'lmo1209', 'lmo1210', 'lmo1211', 'lmo1212', 'lmo1215', 'lmo1216', 'lmo1217', 'lmo1219', 'lmo1220', 'lmo1221', 'lmo1222', 'lmo1225', 'lmo1227', 'lmo1228', 'lmo1230', 'lmo1231', 'lmo1232', 'lmo1233', 'lmo1236', 'lmo1238', 'lmo1239', 'lmo1242', 'lmo1245', 'lmo1246', 'lmo1247', 'lmo1248', 'lmo1249', 'lmo1250', 'lmo1252', 'lmo1253', 'lmo1254', 'lmo1257', 'lmo1258', 'lmo1260', 'lmo1261', 'lmo1262', 'lmo1267', 'lmo1268', 'lmo1269', 'lmo1270', 'lmo1271', 'lmo1272', 'lmo1273', 'lmo1274', 'lmo1286', 'lmo1288', 'lmo1291', 'lmo1292', 'lmo1293', 'lmo1294', 'lmo1295', 'lmo1297', 'lmo1298', 'lmo1301', 'lmo1302', 'lmo1303', 'lmo1304', 'lmo1306', 'lmo1309', 'lmo1310', 'lmo1313', 'lmo1314', 'lmo1315', 'lmo1317', 'lmo1319', 'lmo1322', 'lmo1323', 'lmo1324', 'lmo1325', 'lmo1326', 'lmo1327', 'lmo1329', 'lmo1330', 'lmo1331', 'lmo1332', 'lmo1335', 'lmo1337', 'lmo1338', 'lmo1339', 'lmo1341', 'lmo1342', 'lmo1344', 'lmo1347', 'lmo1348', 'lmo1349', 'lmo1350', 'lmo1351', 'lmo1352', 'lmo1354', 'lmo1355', 'lmo1356', 'lmo1357', 'lmo1358', 'lmo1359', 'lmo1360', 'lmo1361', 'lmo1362', 'lmo1363', 'lmo1365', 'lmo1366', 'lmo1367', 'lmo1369', 'lmo1370', 'lmo1372', 'lmo1373', 'lmo1374', 'lmo1375', 'lmo1376', 'lmo1377', 'lmo1378', 'lmo1379', 'lmo1381', 'lmo1383', 'lmo1385', 'lmo1386', 'lmo1387', 'lmo1388', 'lmo1390', 'lmo1391', 'lmo1392', 'lmo1393', 'lmo1394', 'lmo1396', 'lmo1397', 'lmo1399', 'lmo1400', 'lmo1401', 'lmo1402', 'lmo1404', 'lmo1406', 'lmo1407', 'lmo1408', 'lmo1409', 'lmo1413', 'lmo1415', 'lmo1416', 'lmo1418', 'lmo1419', 'lmo1422', 'lmo1423', 'lmo1424', 'lmo1425', 'lmo1426', 'lmo1428', 'lmo1429', 'lmo1430', 'lmo1433', 'lmo1434', 'lmo1435', 'lmo1436', 'lmo1438', 'lmo1439', 'lmo1440', 'lmo1443', 'lmo1444', 'lmo1445', 'lmo1446', 'lmo1447', 'lmo1448', 'lmo1449', 'lmo1450', 'lmo1453', 'lmo1454', 'lmo1455', 'lmo1456', 'lmo1457', 'lmo1458', 'lmo1459', 'lmo1460', 'lmo1461', 'lmo1462', 'lmo1463', 'lmo1464', 'lmo1465', 'lmo1466', 'lmo1467', 'lmo1468', 'lmo1469', 'lmo1470', 'lmo1471', 'lmo1473', 'lmo1474', 'lmo1475', 'lmo1476', 'lmo1479', 'lmo1480', 'lmo1481', 'lmo1483', 'lmo1484', 'lmo1485', 'lmo1486', 'lmo1488', 'lmo1489', 'lmo1490', 'lmo1491', 'lmo1492', 'lmo1493', 'lmo1494', 'lmo1495', 'lmo1496', 'lmo1497', 'lmo1500', 'lmo1501', 'lmo1502', 'lmo1503', 'lmo1504', 'lmo1505', 'lmo1507', 'lmo1509', 'lmo1510', 'lmo1511', 'lmo1512', 'lmo1513', 'lmo1514', 'lmo1516', 'lmo1517', 'lmo1518', 'lmo1519', 'lmo1520', 'lmo1521', 'lmo1523', 'lmo1524', 'lmo1525', 'lmo1526', 'lmo1527', 'lmo1528', 'lmo1529', 'lmo1530', 'lmo1531', 'lmo1532', 'lmo1533', 'lmo1544', 'lmo1545', 'lmo1546', 'lmo1547', 'lmo1548', 'lmo1552', 'lmo1553', 'lmo1554', 'lmo1555', 'lmo1556', 'lmo1557', 'lmo1559', 'lmo1560', 'lmo1561', 'lmo1562', 'lmo1565', 'lmo1566', 'lmo1567', 'lmo1568', 'lmo1569', 'lmo1571', 'lmo1572', 'lmo1575', 'lmo1577', 'lmo1578', 'lmo1579', 'lmo1580', 'lmo1581', 'lmo1582', 'lmo1583', 'lmo1584', 'lmo1586', 'lmo1587', 'lmo1589', 'lmo1590', 'lmo1591', 'lmo1592', 'lmo1594', 'lmo1595', 'lmo1599', 'lmo1600', 'lmo1602', 'lmo1603', 'lmo1604', 'lmo1606', 'lmo1607', 'lmo1608', 'lmo1609', 'lmo1611', 'lmo1612', 'lmo1613', 'lmo1614', 'lmo1615', 'lmo1616', 'lmo1618', 'lmo1626', 'lmo1627', 'lmo1628', 'lmo1629', 'lmo1630', 'lmo1632', 'lmo1639', 'lmo1640', 'lmo1641', 'lmo1643', 'lmo1645', 'lmo1646', 'lmo1647', 'lmo1649', 'lmo1652', 'lmo1653', 'lmo1654', 'lmo1660', 'lmo1661', 'lmo1662', 'lmo1663', 'lmo1664', 'lmo1665', 'lmo1668', 'lmo1672', 'lmo1673', 'lmo1674', 'lmo1675', 'lmo1676', 'lmo1677', 'lmo1678', 'lmo1679', 'lmo1681', 'lmo1683', 'lmo1684', 'lmo1685', 'lmo1687', 'lmo1688', 'lmo1689', 'lmo1690', 'lmo1691', 'lmo1692', 'lmo1693', 'lmo1698', 'lmo1699', 'lmo1700', 'lmo1701', 'lmo1704', 'lmo1705', 'lmo1706', 'lmo1707', 'lmo1708', 'lmo1709', 'lmo1711', 'lmo1712', 'lmo1713', 'lmo1715', 'lmo1718', 'lmo1720', 'lmo1726', 'lmo1727', 'lmo1728', 'lmo1729', 'lmo1730', 'lmo1732', 'lmo1733', 'lmo1734', 'lmo1735', 'lmo1736', 'lmo1737', 'lmo1739', 'lmo1740', 'lmo1741', 'lmo1742', 'lmo1743', 'lmo1744', 'lmo1745', 'lmo1748', 'lmo1749', 'lmo1750', 'lmo1753', 'lmo1754', 'lmo1755', 'lmo1756', 'lmo1757', 'lmo1758', 'lmo1759', 'lmo1760', 'lmo1761', 'lmo1762', 'lmo1763', 'lmo1764', 'lmo1765', 'lmo1766', 'lmo1767', 'lmo1768', 'lmo1771', 'lmo1772', 'lmo1773', 'lmo1774', 'lmo1775', 'lmo1777', 'lmo1779', 'lmo1780', 'lmo1782', 'lmo1783', 'lmo1784', 'lmo1790', 'lmo1792', 'lmo1793', 'lmo1795', 'lmo1801', 'lmo1802', 'lmo1803', 'lmo1805', 'lmo1806', 'lmo1807', 'lmo1808', 'lmo1809', 'lmo1810', 'lmo1811', 'lmo1813', 'lmo1815', 'lmo1816', 'lmo1817', 'lmo1818', 'lmo1819', 'lmo1820', 'lmo1821', 'lmo1822', 'lmo1823', 'lmo1824', 'lmo1825', 'lmo1826', 'lmo1827', 'lmo1829', 'lmo1830', 'lmo1831', 'lmo1832', 'lmo1833', 'lmo1834', 'lmo1836', 'lmo1837', 'lmo1838', 'lmo1839', 'lmo1854', 'lmo1856', 'lmo1857', 'lmo1859', 'lmo1860', 'lmo1861', 'lmo1862', 'lmo1863', 'lmo1864', 'lmo1865', 'lmo1866', 'lmo1868', 'lmo1869', 'lmo1870', 'lmo1871', 'lmo1873', 'lmo1874', 'lmo1875', 'lmo1888', 'lmo1889', 'lmo1891', 'lmo1893', 'lmo1894', 'lmo1895', 'lmo1896', 'lmo1897', 'lmo1898', 'lmo1899', 'lmo1900', 'lmo1901', 'lmo1902', 'lmo1903', 'lmo1904', 'lmo1905', 'lmo1906', 'lmo1908', 'lmo1909', 'lmo1911', 'lmo1912', 'lmo1913', 'lmo1914', 'lmo1915', 'lmo1916', 'lmo1917', 'lmo1918', 'lmo1919', 'lmo1921', 'lmo1922', 'lmo1923', 'lmo1924', 'lmo1925', 'lmo1926', 'lmo1927', 'lmo1928', 'lmo1933', 'lmo1935', 'lmo1936', 'lmo1939', 'lmo1940', 'lmo1942', 'lmo1944', 'lmo1947', 'lmo1948', 'lmo1949', 'lmo1950', 'lmo1951', 'lmo1952', 'lmo1953', 'lmo1954', 'lmo1955', 'lmo1965', 'lmo1966', 'lmo1967', 'lmo1976', 'lmo1977', 'lmo1978', 'lmo1979', 'lmo1981', 'lmo1982', 'lmo1983', 'lmo1984', 'lmo1985', 'lmo1986', 'lmo1987', 'lmo1988', 'lmo1989', 'lmo1990', 'lmo1991', 'lmo1992', 'lmo1997', 'lmo1998', 'lmo1999', 'lmo2000', 'lmo2001', 'lmo2002', 'lmo2003', 'lmo2004', 'lmo2005', 'lmo2006', 'lmo2007', 'lmo2008', 'lmo2009', 'lmo2011', 'lmo2012', 'lmo2013', 'lmo2015', 'lmo2017', 'lmo2018', 'lmo2019', 'lmo2020', 'lmo2021', 'lmo2039', 'lmo2040', 'lmo2041', 'lmo2042', 'lmo2044', 'lmo2048', 'lmo2049', 'lmo2051', 'lmo2058', 'lmo2059', 'lmo2061', 'lmo2062', 'lmo2063', 'lmo2064', 'lmo2065', 'lmo2067', 'lmo2068', 'lmo2072', 'lmo2073', 'lmo2075', 'lmo2076', 'lmo2077', 'lmo2078', 'lmo2079', 'lmo2080', 'lmo2082', 'lmo2083', 'lmo2086', 'lmo2087', 'lmo2090', 'lmo2091', 'lmo2094', 'lmo2095', 'lmo2096', 'lmo2100', 'lmo2102', 'lmo2103', 'lmo2104', 'lmo2105', 'lmo2106', 'lmo2107', 'lmo2108', 'lmo2110', 'lmo2111', 'lmo2112', 'lmo2113', 'lmo2114', 'lmo2115', 'lmo2116', 'lmo2117', 'lmo2118', 'lmo2119', 'lmo2120', 'lmo2122', 'lmo2123', 'lmo2124', 'lmo2125', 'lmo2126', 'lmo2127', 'lmo2139', 'lmo2140', 'lmo2141', 'lmo2142', 'lmo2145', 'lmo2146', 'lmo2147', 'lmo2149', 'lmo2150', 'lmo2151', 'lmo2152', 'lmo2153', 'lmo2154', 'lmo2155', 'lmo2156', 'lmo2158', 'lmo2159', 'lmo2161', 'lmo2162', 'lmo2163', 'lmo2164', 'lmo2165', 'lmo2166', 'lmo2167', 'lmo2168', 'lmo2169', 'lmo2170', 'lmo2171', 'lmo2172', 'lmo2173', 'lmo2174', 'lmo2175', 'lmo2176', 'lmo2177', 'lmo2179', 'lmo2180', 'lmo2181', 'lmo2182', 'lmo2184', 'lmo2185', 'lmo2187', 'lmo2188', 'lmo2189', 'lmo2190', 'lmo2191', 'lmo2194', 'lmo2195', 'lmo2196', 'lmo2197', 'lmo2198', 'lmo2199', 'lmo2200', 'lmo2201', 'lmo2202', 'lmo2204', 'lmo2205', 'lmo2206', 'lmo2208', 'lmo2209', 'lmo2210', 'lmo2211', 'lmo2212', 'lmo2213', 'lmo2214', 'lmo2215', 'lmo2216', 'lmo2217', 'lmo2223', 'lmo2225', 'lmo2227', 'lmo2228', 'lmo2229', 'lmo2230', 'lmo2231', 'lmo2232', 'lmo2233', 'lmo2234', 'lmo2235', 'lmo2236', 'lmo2237', 'lmo2238', 'lmo2241', 'lmo2243', 'lmo2244', 'lmo2245', 'lmo2246', 'lmo2247', 'lmo2248', 'lmo2249', 'lmo2254', 'lmo2256', 'lmo2258', 'lmo2259', 'lmo2260', 'lmo2261', 'lmo2262', 'lmo2263', 'lmo2264', 'lmo2265', 'lmo2266', 'lmo2267', 'lmo2268', 'lmo2334', 'lmo2337', 'lmo2338', 'lmo2339', 'lmo2340', 'lmo2341', 'lmo2342', 'lmo2343', 'lmo2344', 'lmo2346', 'lmo2348', 'lmo2349', 'lmo2350', 'lmo2352', 'lmo2353', 'lmo2356', 'lmo2357', 'lmo2358', 'lmo2360', 'lmo2361', 'lmo2366', 'lmo2367', 'lmo2369', 'lmo2370', 'lmo2371', 'lmo2374', 'lmo2376', 'lmo2377', 'lmo2380', 'lmo2381', 'lmo2382', 'lmo2383', 'lmo2384', 'lmo2385', 'lmo2386', 'lmo2387', 'lmo2388', 'lmo2389', 'lmo2390', 'lmo2392', 'lmo2393', 'lmo2397', 'lmo2398', 'lmo2399', 'lmo2401', 'lmo2402', 'lmo2403', 'lmo2404', 'lmo2405', 'lmo2406', 'lmo2411', 'lmo2412', 'lmo2413', 'lmo2414', 'lmo2415', 'lmo2416', 'lmo2417', 'lmo2418', 'lmo2421', 'lmo2422', 'lmo2424', 'lmo2425', 'lmo2426', 'lmo2427', 'lmo2428', 'lmo2429', 'lmo2430', 'lmo2431', 'lmo2433', 'lmo2434', 'lmo2435', 'lmo2436', 'lmo2437', 'lmo2438', 'lmo2439', 'lmo2441', 'lmo2442', 'lmo2448', 'lmo2449', 'lmo2450', 'lmo2456', 'lmo2457', 'lmo2458', 'lmo2459', 'lmo2460', 'lmo2464', 'lmo2465', 'lmo2467', 'lmo2468', 'lmo2473', 'lmo2474', 'lmo2475', 'lmo2476', 'lmo2477', 'lmo2478', 'lmo2479', 'lmo2482', 'lmo2483', 'lmo2484', 'lmo2485', 'lmo2486', 'lmo2487', 'lmo2488', 'lmo2489', 'lmo2490', 'lmo2492', 'lmo2493', 'lmo2494', 'lmo2495', 'lmo2496', 'lmo2497', 'lmo2498', 'lmo2499', 'lmo2500', 'lmo2501', 'lmo2504', 'lmo2505', 'lmo2506', 'lmo2507', 'lmo2508', 'lmo2510', 'lmo2511', 'lmo2512', 'lmo2513', 'lmo2514', 'lmo2515', 'lmo2518', 'lmo2519', 'lmo2521', 'lmo2523', 'lmo2524', 'lmo2525', 'lmo2526', 'lmo2527', 'lmo2528', 'lmo2529', 'lmo2530', 'lmo2531', 'lmo2532', 'lmo2533', 'lmo2534', 'lmo2537', 'lmo2539', 'lmo2540', 'lmo2541', 'lmo2542', 'lmo2543', 'lmo2544', 'lmo2545', 'lmo2546', 'lmo2547', 'lmo2559', 'lmo2560', 'lmo2561', 'lmo2562', 'lmo2563', 'lmo2564', 'lmo2566', 'lmo2567', 'lmo2568', 'lmo2569', 'lmo2570', 'lmo2571', 'lmo2572', 'lmo2573', 'lmo2574', 'lmo2575', 'lmo2577', 'lmo2578', 'lmo2579', 'lmo2581', 'lmo2582', 'lmo2583', 'lmo2584', 'lmo2585', 'lmo2586', 'lmo2587', 'lmo2588', 'lmo2589', 'lmo2591', 'lmo2596', 'lmo2599', 'lmo2600', 'lmo2601', 'lmo2602', 'lmo2603', 'lmo2605', 'lmo2606', 'lmo2607', 'lmo2608', 'lmo2611', 'lmo2612', 'lmo2613', 'lmo2614', 'lmo2615', 'lmo2617', 'lmo2619', 'lmo2620', 'lmo2621', 'lmo2622', 'lmo2623', 'lmo2624', 'lmo2625', 'lmo2638', 'lmo2640', 'lmo2641', 'lmo2642', 'lmo2643', 'lmo2644a', 'lmo2646', 'lmo2647', 'lmo2648', 'lmo2649', 'lmo2650', 'lmo2651', 'lmo2653', 'lmo2655', 'lmo2656', 'lmo2657', 'lmo2658', 'lmo2659', 'lmo2661', 'lmo2662', 'lmo2663', 'lmo2664', 'lmo2665', 'lmo2666', 'lmo2667', 'lmo2668', 'lmo2669', 'lmo2670', 'lmo2673', 'lmo2674', 'lmo2677', 'lmo2678', 'lmo2679', 'lmo2680', 'lmo2681', 'lmo2682', 'lmo2683', 'lmo2684', 'lmo2688', 'lmo2689', 'lmo2690', 'lmo2692', 'lmo2694', 'lmo2695', 'lmo2696', 'lmo2697', 'lmo2698', 'lmo2699', 'lmo2700', 'lmo2701', 'lmo2702', 'lmo2703', 'lmo2704', 'lmo2705', 'lmo2706', 'lmo2707', 'lmo2710', 'lmo2712', 'lmo2713', 'lmo2714', 'lmo2715', 'lmo2716', 'lmo2717', 'lmo2718', 'lmo2719', 'lmo2720', 'lmo2722', 'lmo2723', 'lmo2725', 'lmo2726', 'lmo2727', 'lmo2728', 'lmo2730', 'lmo2731', 'lmo2738', 'lmo2739', 'lmo2741', 'lmo2742', 'lmo2744', 'lmo2745', 'lmo2746', 'lmo2747', 'lmo2748', 'lmo2749', 'lmo2754', 'lmo2755', 'lmo2757', 'lmo2758', 'lmo2759', 'lmo2761', 'lmo2762', 'lmo2763', 'lmo2764', 'lmo2766', 'lmo2769', 'lmo2770', 'lmo2777', 'lmo2778', 'lmo2779', 'lmo2789', 'lmo2790', 'lmo2791', 'lmo2792', 'lmo2793', 'lmo2794', 'lmo2795', 'lmo2796', 'lmo2797', 'lmo2798', 'lmo2800', 'lmo2802', 'lmo2810', 'lmo2812', 'lmo2814', 'lmo2815', 'lmo2816', 'lmo2817', 'lmo2818', 'lmo2819', 'lmo2822', 'lmo2823', 'lmo2824', 'lmo2825', 'lmo2826', 'lmo2827', 'lmo2830', 'lmo2831', 'lmo2832', 'lmo2833', 'lmo2835', 'lmo2836', 'lmo2837', 'lmo2838', 'lmo2839', 'lmo2842', 'lmo2844', 'lmo2845', 'lmo2852', 'lmo2853', 'lmo2854']
    num_loci = len(list_loci)
    d = defaultdict(dict)
    with open(infile, 'r') as mlst:
        for line in mlst:
            if  line.split('\t')[0].split('_')[0] in d[line.split('\t')[1]]:
                allele_list = d[line.split('\t')[1]][line.split('\t')[0].split('_')[0]]
                allele_list.append(line.strip().split('\t')[0].split('_')[1])
                d[line.split('\t')[1]][line.split('\t')[0].split('_')[0]] = allele_list
            else:    
                d[line.split('\t')[1]][line.split('\t')[0].split('_')[0]] = [line.strip().split('\t')[0].split('_')[1]]
    '''
    for key in d:
        print(key)
        for v in d[key]:
            if len(d[key][v]) > 1:
                print('\t'+ v + ' ' + str(d[key][v]))
    '''
    with open(prefix + '.report.out', 'w') as out:
        for key in d:
            alleles_called = 0
            alleles_multiple = 0
            for v in d[key]:
                alleles_called += 1
                if len(d[key][v]) > 1:
                    alleles_multiple += 1
            out.write(key + '; total: ' + str(alleles_called) + '/' + str(num_loci) + ', multiple: ' + str(alleles_multiple) + '\n')
    
    detailed = open(prefix +'.detailed.tsv', 'w')

    with open(prefix + '.raw.tsv', 'w') as out:
        out.write('\t' +'\t'.join(list_loci) + '\n')
        detailed.write('\t' +'\t'.join(list_loci) + '\n')
        for key in d:
            alleles = [key]
            alleles_detailed = [key]
            for l in list_loci:
                try:
                    a = d[key][l]
                    if len(a) == 1:
                        alleles.append(a[0])
                        alleles_detailed.append(a[0])
                    else:
                        alleles.append('NA')
                        alleles_detailed.append('MULTI')
                except KeyError:
                    alleles.append('NA')
                    alleles_detailed.append('NOT_CALLED')
            out.write('\t'.join(alleles) + '\n')
            detailed.write('\t'.join(alleles_detailed) + '\n')
    detailed.close()

    outfile = open(prefix +'.clean.tsv', 'w')
    dropped = open(prefix +'.dropped.txt', 'w')
    #cleaning up table according to Pasteur recommendations for LM cgMLST, not applicable to 7 gene or other MLST schemes
    with open(prefix + '.raw.tsv', 'r') as infile:
        for line in infile:
            if line.strip().split('\t').count('NA') > 87:
                dropped.write(line.strip().split('\t')[0] + '\n')
            else:
                outfile.write(line)
            
    dropped.close()
    outfile.close()

if __name__ == '__main__':
    main()
